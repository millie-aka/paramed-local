!function(n){var e=n("#field_date_input_type"),a=n("#gpld-minimum-date"),d=n("#gpld-maximum-date"),i=n("#gpld-min-date-modifier"),o=n("#gpld-min-date-exclude-before-today"),r=n("#gpld-min-date-exclude-before-today-modifier"),l=n("#gpld-max-date-modifier"),c=n("#gpld-min-date-input"),p=n("#gpld-max-date-input"),t=n(".gpld-date-input-reset"),s=n("#gpld-all-days"),m=n(".gpld-days-of-week-container input"),f=n(".gpld-exceptions-repeater"),u=n("#gpld-add-exception"),h=n("#gpld-add-exception-input"),y=n("#gpld-inline-datepicker"),g=function(e){return GPLD_ADMIN.key+e};function v(e){var t;"date"==GetInputType(e)&&"datepicker"==e.dateType?(n(".gp-limit-dates-field-settings").show(),n(".gpld-date-select-container").show(),n(".gpld-date-modifier-container").hide(),n(".gpld-date-input-container").hide(),n(".gpld-all-days-container").show(),n(".gpld-days-of-week-container").hide(),k(a,e),a.val(e[g("minDate")]),a.change(),c.val(e[g("minDateValue")]),i.val(e[g("minDateMod")]),o.attr("checked",!0===e[g("minDateExcludeBeforeToday")]).change(),r.val(e[g("minDateExcludeBeforeTodayMod")]),k(d,e),d.val(e[g("maxDate")]),d.change(),p.val(e[g("maxDateValue")]),l.val(e[g("maxDateMod")]),fieldDateFormat=G(e.dateFormat),t="object"==typeof field[g("daysOfWeek")]?field[g("daysOfWeek")]:[0,1,2,3,4,5,6],m.each(function(){n(this).prop("checked",-1!=n.inArray(parseInt(n(this).val()),t))}),0<t.length&&t.length<7&&(j(!0),F()),function(){var e=function(){var e="object"==typeof field[g("exceptions")]?field[g("exceptions")]:[],t=[];if(e.length<=0)t.push({date:"",formattedDate:""});else for(var a=0;a<e.length;a++)t.push({date:e[a],formattedDate:I(e[a])});return t}();f.data("htmlTemplate")?f.html(f.data("htmlTemplate")):f.data("htmlTemplate",f.html());f.repeater({limit:0,items:e,minItemCount:0,addButtonMarkup:"",removeButtonMarkup:'<span class="remove"><i class="fa fa-times"></i></span>',callbacks:{save:function(e,t){for(var a=[],d=0;d<t.length;d++){var i=t[d].date.split("/");t[d].dateObj=new Date(i[2],i[0],i[1]),t[d].formattedDate=I(t[d].date)}for(t.sort(function(e,t){return e.dateObj>t.dateObj?1:-1}),e.refresh(),d=0;d<t.length;d++)a.push(t[d].date);SetFieldProperty(g("exceptions"),a)}}}),1!=e.length||e[0].date||f.removeItem(0);n("#field_date_format").on("change",function(){f.save()})}(),y.prop("checked",1==e[g("inlineDatepicker")]),c.datepicker({dateFormat:fieldDateFormat}).val(I(e[g("minDateValue")],!0)).on("change",function(){SetFieldProperty(g("minDateValue"),T(this.value))}),p.datepicker({dateFormat:fieldDateFormat}).val(I(e[g("maxDateValue")],!0)).on("change",function(){SetFieldProperty(g("maxDateValue"),T(this.value))}),n("#field_date_format").on("change",function(){fieldDateFormat=G(e.dateFormat),c.datepicker("option","dateFormat",fieldDateFormat),p.datepicker("option","dateFormat",fieldDateFormat),c.val(I(e[g("minDateValue")],!0)),p.val(I(e[g("maxDateValue")],!0))})):n(".gp-limit-dates-field-settings").hide()}function k(e,d){n.each(GPLD_ADMIN.dateSelectOptions,function(e,t){if("_datefields_"==t.value){t.options=[];for(var a=0;a<form.fields.length;a++)d.id!=form.fields[a].id&&"date"==GetInputType(form.fields[a])&&"datepicker"==form.fields[a].dateType&&t.options.push({label:GetLabel(form.fields[a]),value:form.fields[a].id})}}),e.html(function a(e){var d="";n.each(e,function(e,t){void 0!==t.options?d+='<optgroup label="'+t.label+'">'+a(t.options)+"</optgroup>":d+='<option value="'+t.value+'">'+t.label+"</option>"});return d}(GPLD_ADMIN.dateSelectOptions))}function D(e){var t,a,d,i,n=e.val(),o="_custom_"==n,r="gpld-minimum-date"===e.attr("id");n?o?(i=(d=e).parents(".gp-group").find(".gpld-date-input-container"),d.parent().hide(),i.show(),_(e),r&&((a=jQuery("#gpld-min-date-exclude-before-today-container").parents(".gp-row")).is(":visible")||a.show())):((t=e.parents(".gp-row").find(".gpld-date-modifier-container")).is(":visible")||t.show(),r&&b()):(_(e),r&&(b(),x()))}function _(e){e.parents(".gp-row").find(".gpld-date-modifier-container").hide().find("input").val("").change().keyup()}function b(){jQuery("#gpld-min-date-exclude-before-today-container").parents(".gp-row").hide().find("input").attr("checked",!1)}function x(){jQuery("#gpld-min-date-exclude-before-today-modifier-container").hide().find("input").val("").change().keyup()}function F(){var e=n(".gpld-days-of-week-container"),t=w().length;0<t?e.addClass("has-selection").removeClass("no-selection"):e.addClass("no-selection").removeClass("has-selection"),7<=t&&j(),SetFieldProperty(g("daysOfWeek"),w())}function w(){var a=[];return n.each(m.filter(":checked"),function(e,t){a.push(parseInt(t.value))}),a}function j(e){e=void 0!==e&&e;var t=n(".gpld-all-days-container"),a=n(".gpld-days-of-week-container"),d=t.is(":visible")||e?t:a,i=t.is(":visible")||e?a:t;d.hide(),i.show()}function S(e){return("0"+e).slice(-2)}function I(e,t){if(!e)return"";var a=e.split("/"),d=GetSelectedField().dateFormat.split("_"),i=d[0]?d[0]:"mdy",n=d[1]?d[1]:"slash",o=S(a[0]),r=S(a[1]),l=a[2];return void 0===t||!t||o&&r&&l?i.split("").join({slash:"/",dot:".",dash:"-"}[n]).replace("m",o).replace("d",r).replace("y",l):""}function T(e){var t=GetSelectedField().dateFormat;if("mdy"==t)return e;var a,d,i,n=t.split("_"),o=n[0]?n[0]:"mdy",r=n[1]?n[1]:"slash",l=e.split({slash:"/",dot:".",dash:"-"}[r]);return"mdy"===o?(a=l[0],d=l[1],i=l[2]):"dmy"===o?(a=l[1],d=l[0],i=l[2]):"ymd"===o&&(a=l[1],d=l[2],i=l[0]),a&&d&&i?"mdy".split("").join("/").replace("m",S(a)).replace("d",S(d)).replace("y",i):""}function G(e){switch(e){case"mdy":return"mm/dd/yy";case"mdy_dot":return"mm.dd.yy";case"mdy_dash":return"mm-dd-yy";case"dmy":return"dd/mm/yy";case"dmy_dot":return"dd.mm.yy";case"dmy_dash":return"dd-mm-yy";case"ymd":return"yy/mm/dd";case"ymd_dot":return"yy.mm.dd";case"ymd_dash":return"yy-mm-dd"}return"mm/dd/yy"}e.change(function(){v(GetSelectedField()),gperk.togglePerksTab()}),a.change(function(){D(n(this))}),o.change(function(){var e;n(this).is(":checked")?(e=jQuery("#gpld-min-date-exclude-before-today-modifier-container")).is(":visible")||e.show():x()}),d.change(function(){D(n(this))}),t.click(function(){var e,t,a;e=n(this),t=e.parents(".gpld-date-input-container"),a=t.parents(".gp-row").find(".gpld-date-select-container"),t.hide(),t.find("input").val("").change(),a.find("select").val("").change(),a.show()}),s.click(function(){m.prop("checked",!1),SetFieldProperty(g("daysOfWeek"),w()),F(),j()}),m.change(function(){F()}),u.click(function(){h.datepicker({dateFormat:"mm/dd/yy",onSelect:function(e){f.addNewItem({date:e,formattedDate:I(e)})}}).datepicker("show")}),n(document).bind("gform_load_field_settings",function(e,t,a){v(t)})}(jQuery);
//# sourceMappingURL=gp-limit-dates-admin.js.map